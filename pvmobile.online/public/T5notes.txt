SELECT OrderStatus, DATEDIFF(day, GETDATE(), DeliverBy) AS date1 INTO Defects2147130071 FROM BranchOrders WHERE (Type = 5) AND (ProjectID = 'D7ECE2E8-45F0-42B2-BCEC-1B2981B9CF69') AND (OrderStatus <> 0) AND (OrderStatus < 54)SELECT OrderStatus, COUNT(CASE WHEN date1 < 0 THEN 1 ELSE NULL END) AS Late, COUNT(CASE WHEN date1 >= 0 THEN 1 ELSE NULL END) AS OK FROM Defects2147130071 GROUP BY OrderStatusDrop table Defects2147130071 